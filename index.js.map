{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["/**\n * Pixabay API integration module\n * Handles image search requests and response processing\n */\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// API Configuration\nconst API_CONFIG = {\n  BASE_URL: 'https://pixabay.com/api/',\n  API_KEY: '38590711-cd4e1138b2603dfebaf6d7de9',\n  DEFAULT_PARAMS: {\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15, // Зменшуємо до 15 елементів за запит\n  },\n};\n\n// Toast configuration for API errors\nconst TOAST_CONFIG = {\n  closeOnClick: true,\n  position: 'topRight',\n  displayMode: 0,\n  progressBar: false,\n};\n\n/**\n * Fetches images from Pixabay API based on search query and page number\n * @param {string} inputValue - The search query\n * @param {number} page - The page number for pagination (default: 1)\n * @returns {Promise<Object>} The API response data\n * @throws {Error} If the input is empty or API request fails\n */\nexport async function pixabayApi(inputValue, page = 1) {\n  // Validate input\n  if (!inputValue?.trim()) {\n    throw new Error('Please enter a search query');\n  }\n\n  // Prepare search parameters\n  const searchParams = {\n    ...API_CONFIG.DEFAULT_PARAMS,\n    q: inputValue.trim().toLowerCase(),\n    page: page,\n  };\n\n  try {\n    const response = await axios.get(API_CONFIG.BASE_URL, {\n      params: {\n        key: API_CONFIG.API_KEY,\n        ...searchParams,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    const errorMessage =\n      error.response?.data?.message ||\n      error.message ||\n      'Failed to fetch images. Please try again.';\n    iziToast.error({\n      ...TOAST_CONFIG,\n      message: errorMessage,\n    });\n    throw new Error(errorMessage);\n  }\n}","/**\n * Gallery rendering module\n * Handles the creation of gallery items and their HTML structure\n */\n\n/**\n * Creates HTML markup for a single gallery item\n * @param {Object} image - The image data object\n * @returns {string} HTML markup for the gallery item\n */\nconst createGalleryItem = ({\n  comments,\n  downloads,\n  likes,\n  largeImageURL,\n  previewURL,\n  views,\n}) => `\n  <li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${previewURL}\"\n        alt=\"Gallery image\"\n        loading=\"lazy\"\n      />\n    </a>\n    <div class=\"image-descriptions-container\">\n      <div class=\"small-descriptions-container\">\n        <p>Likes</p>\n        <p>${likes}</p>\n      </div>\n      <div class=\"small-descriptions-container\">\n        <p>Views</p>\n        <p>${views}</p>\n      </div>\n      <div class=\"small-descriptions-container\">\n        <p>Comments</p>\n        <p>${comments}</p>\n      </div>\n      <div class=\"small-descriptions-container\">\n        <p>Downloads</p>\n        <p>${downloads}</p>\n      </div>\n    </div>\n  </li>\n`;\n\n/**\n * Renders the gallery with the provided posts\n * @param {Array} posts - Array of image data objects\n * @returns {string} Complete HTML markup for the gallery\n */\nexport function renderFunction(posts) {\n  if (!Array.isArray(posts) || posts.length === 0) {\n    return '';\n  }\n\n  const markup = posts.map(createGalleryItem).join('');\n\n  // Use setTimeout to ensure the DOM is updated before adding animation classes\n  setTimeout(() => {\n    const items = document.querySelectorAll('.gallery-item');\n    items.forEach(item => {\n      item.classList.add('animate');\n    });\n  }, 0);\n\n  return markup;\n}\n\n/**\n * Smoothly scrolls the page after loading new images\n * @param {number} cardHeight - Height of a single gallery card\n */\nexport function smoothScroll(cardHeight) {\n  const scrollDistance = cardHeight * 2;\n  window.scrollBy({\n    top: scrollDistance,\n    behavior: 'smooth',\n  });\n}","/**\n * Main application file for the image search gallery\n * Handles form submission, image loading, pagination, and gallery initialization\n */\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { pixabayApi } from './js/pixabay-api.js';\nimport { renderFunction, smoothScroll } from './js/render-functions.js';\n\n// DOM Elements\nconst DOM = {\n  form: document.querySelector('form'),\n  gallery: document.querySelector('.gallery'),\n  input: document.querySelector('input[type=\"text\"]'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n  loadMoreContainer: document.querySelector('.load-more-container'),\n};\n\n// Lightbox configuration\nconst LIGHTBOX_CONFIG = {\n  captions: true,\n  captionsData: 'alt',\n  captionSelector: 'img',\n  captionPosition: 'outside',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n  styles: '../css/styles.css',\n};\n\n// Toast configuration\nconst TOAST_CONFIG = {\n  closeOnClick: true,\n  position: 'topRight',\n  displayMode: 0,\n  progressBar: false,\n  backgroundColor: '#EF4040',\n  messageColor: 'white',\n  iconColor: 'white',\n  maxWidth: '432px',\n};\n\n// Application state\nconst state = {\n  currentPage: 1,\n  currentQuery: '',\n  totalHits: 0,\n  lightbox: null,\n};\n\n/**\n * Shows or hides the loader\n * @param {boolean} show - Whether to show the loader\n */\nfunction toggleLoader(show) {\n  if (show) {\n    DOM.loader.classList.add('visible');\n  } else {\n    DOM.loader.classList.remove('visible');\n  }\n}\n\n/**\n * Shows or hides the load more button\n * @param {boolean} show - Whether to show the button\n */\nfunction toggleLoadMoreButton(show) {\n  DOM.loadMoreBtn.style.display = show ? 'block' : 'none';\n}\n\n/**\n * Shows end of collection message\n */\nfunction showEndMessage() {\n  iziToast.info({\n    ...TOAST_CONFIG,\n    backgroundColor: '#4CAF50',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n\n/**\n * Handles the load more button click\n */\nconst handleLoadMore = async () => {\n  if (!state.currentQuery) return;\n\n  state.currentPage += 1;\n  toggleLoadMoreButton(false);\n  toggleLoader(true);\n\n  try {\n    const response = await pixabayApi(state.currentQuery, state.currentPage);\n\n    if (response.hits.length === 0) {\n      showEndMessage();\n      return;\n    }\n\n    // Add new images to gallery\n    const newMarkup = renderFunction(response.hits);\n    DOM.gallery.insertAdjacentHTML('beforeend', newMarkup);\n\n    // Refresh lightbox\n    if (state.lightbox) {\n      state.lightbox.refresh();\n    }\n\n    // Smooth scroll\n    const galleryItems = document.querySelectorAll('.gallery-item');\n    if (galleryItems.length > 0) {\n      const cardHeight = galleryItems[0].getBoundingClientRect().height;\n      smoothScroll(cardHeight);\n    }\n\n    // Check if we've reached the end\n    const totalLoaded = state.currentPage * 15; // 15 items per page\n    if (totalLoaded >= response.totalHits) {\n      toggleLoadMoreButton(false);\n      showEndMessage();\n    } else {\n      toggleLoadMoreButton(true);\n    }\n  } catch (error) {\n    iziToast.error({\n      ...TOAST_CONFIG,\n      message: error.message || 'Failed to load more images',\n    });\n    toggleLoadMoreButton(true);\n  } finally {\n    toggleLoader(false);\n  }\n};\n\n/**\n * Handles the form submission and initial image search\n * @param {Event} e - The submit event\n */\nconst handleSubmit = async e => {\n  e.preventDefault();\n\n  const query = DOM.input.value.trim();\n  if (!query) {\n    iziToast.error({\n      ...TOAST_CONFIG,\n      message: 'Please enter a search query',\n    });\n    return;\n  }\n\n  // Reset state for new search\n  state.currentPage = 1;\n  state.currentQuery = query;\n\n  // Clear previous results\n  DOM.gallery.innerHTML = '';\n  toggleLoadMoreButton(false);\n  toggleLoader(true);\n\n  // Refresh lightbox if it exists\n  if (state.lightbox) {\n    state.lightbox.destroy();\n    state.lightbox = null;\n  }\n\n  try {\n    const response = await pixabayApi(query, state.currentPage);\n\n    if (response.hits.length === 0) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n\n    // Render gallery\n    DOM.gallery.innerHTML = renderFunction(response.hits);\n\n    // Initialize lightbox\n    state.lightbox = new SimpleLightbox('.gallery a', LIGHTBOX_CONFIG);\n\n    // Show load more button if there are more images\n    if (response.hits.length < response.totalHits) {\n      toggleLoadMoreButton(true);\n    }\n\n    state.totalHits = response.totalHits;\n  } catch (error) {\n    iziToast.error({\n      ...TOAST_CONFIG,\n      message: error.message || 'Failed to fetch images',\n    });\n  } finally {\n    toggleLoader(false);\n  }\n};\n\n// Event Listeners\nDOM.form.addEventListener('submit', handleSubmit);\nDOM.loadMoreBtn.addEventListener('click', handleLoadMore);"],"names":["API_CONFIG","TOAST_CONFIG","pixabayApi","inputValue","page","searchParams","axios","error","errorMessage","_b","_a","iziToast","createGalleryItem","comments","downloads","likes","largeImageURL","previewURL","views","renderFunction","posts","markup","item","smoothScroll","cardHeight","scrollDistance","DOM","LIGHTBOX_CONFIG","state","toggleLoader","show","toggleLoadMoreButton","showEndMessage","handleLoadMore","response","newMarkup","galleryItems","handleSubmit","query","SimpleLightbox"],"mappings":"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"}